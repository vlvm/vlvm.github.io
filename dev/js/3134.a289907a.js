"use strict";(self["webpackChunkteacher_project"]=self["webpackChunkteacher_project"]||[]).push([[3134],{23134:function(t,e,n){n.r(e),n.d(e,{default:function(){return h}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quesContent",class:{active:t.courseContentId===t.data.id&&t.isNoChecking,important:(1===t.data.pointSwitch||1===t.data.mustHandleSwitch)&&2!==t.data.type},on:{click:t.questionClick}},[n("ul",{directives:[{name:"show",rawName:"v-show",value:t.courseContentId===t.data.id&&t.isNoChecking&&!t.isOtherTeacher,expression:"courseContentId === data.id && isNoChecking && !isOtherTeacher"}]},[2===t.contentType?[null!==t.data.firstQuestionId?n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick(-1)}}},[t._v(" 取消关联 ")]):t._e(),t.relationData.length>1&&null===t.data.firstQuestionId?n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("0")}}},[t._v(" 多题关联 ")]):t._e(),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("1")}}},[t._v("连续编号")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("2")}}},[t._v("连续设分")])]:t._e(),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("3")}}},[t._v("多选")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("4")}}},[t._v("拷贝")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("5")}}},[t._v("粘贴")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("6")}}},[t._v("删除")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("7")}}},[t._v("编辑")])],2),n("div",{staticClass:"item"},["0"===t.editorType&&t.relationData.includes(t.data.id)&&null===t.data.firstQuestionId?n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:function(e){return t.relationChange(e,t.data.id)}}}):t._e(),2!==t.contentType||"1"!==t.editorType&&"2"!==t.editorType?t._e():n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:t.numberChange}}),"3"===t.editorType?n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:function(e){return t.checkContent(e)}}}):t._e(),0===t.contentType&&0!==t.data.titleLevel?n("a-icon",{attrs:{type:"caret-down"}}):t._e(),0===t.contentType?n("div",{staticClass:"txt",domProps:{innerHTML:t._s(t.data.textContent)}}):t._e(),1===t.contentType?n("div",{staticClass:"file"},[n("a-icon",{style:{fontSize:"32px",color:"#3E8AF9",marginRight:"10px"},attrs:{type:t.getFileIcon(t.data.attachmentExtraName)}}),n("a",{attrs:{href:"/exam/"+t.data.attachmentLinkAddress}},[t._v(" "+t._s(t.data.attachmentName)+" ")])],1):t._e(),2===t.contentType?[n("div",{staticClass:"itemContent"},[n("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center","margin-bottom":"5px"},on:{click:function(t){t.stopPropagation()}}},[n("a-tag",[t._v("题号："+t._s(t.data.questionNumber))]),n("span",[t._v("分数：")]),n("a-input-number",{staticStyle:{width:"50px",height:"22px","line-height":"22px","margin-right":"10px"},attrs:{size:"small",min:1,max:1e5,value:t.data.questionScore,disabled:2===t.contentType&&("1"===t.editorType||"2"===t.editorType)},on:{change:t.changeScore}}),1===t.data.mustDoSwitch?n("a-tag",{attrs:{color:"#FF9933"}},[t._v("必做")]):t._e(),1===t.data.selfReadOverSwitch?n("a-tag",{attrs:{color:"#FF9933"}},[t._v(" 自阅 ")]):t._e(),null!==t.data.firstQuestionId?n("a-tag",{attrs:{color:"#FF9933"}},[n("span",{staticClass:"iconfont lx-guanlian",staticStyle:{color:"#fff"}})]):t._e()],1),2!==t.showAnswerArea?[n("div",{staticClass:"txt",domProps:{innerHTML:t._s(t.data.questionStem)}}),t.courseContentId===t.data.id?[n("div",{staticClass:"rightAnswer"},[n("div",[t._v("答案：")]),n("div",{staticClass:"questionAnswer",domProps:{innerHTML:t._s(t.data.answer)}})]),n("div",{staticClass:"analysis"},[n("div",[t._v("解析：")]),n("div",{staticClass:"questionAnalysis",domProps:{innerHTML:t._s(t.data.questionAnalysis)}})])]:t._e()]:t._e(),0===t.data.questionType?t._l(t.data.chooseZoneCounts,(function(e){return n("div",{key:e,staticStyle:{display:"flex","align-items":"center"}},[1===t.showAnswerArea||2===t.showAnswerArea?n("span",[t._v(t._s(e)+".")]):t._e(),1===t.showAnswerArea||2===t.showAnswerArea?n("ol",{staticClass:"singleChoice"},t._l(t.data.answerCard.split(","),(function(e){return n("li",{key:e},[t._v(" "+t._s(e)+" ")])})),0):t._e()])})):t._e(),[2,3].includes(t.data.questionType)?n("div",[1===t.showAnswerArea||2===t.showAnswerArea?n("ol",{staticClass:"singleChoice",on:{click:function(t){t.stopPropagation()}}},[n("li",{class:{answerWayActive:1===t.data.answerWayPhoto},on:{click:function(e){return t.changeAnswerType(0,t.data.id)}}},[t._v(" 拍照 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayHandle},on:{click:function(e){return t.changeAnswerType(1,t.data.id)}}},[t._v(" 手写 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayTalking},on:{click:function(e){return t.changeAnswerType(2,t.data.id)}}},[t._v(" 音频 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayVideo},on:{click:function(e){return t.changeAnswerType(3,t.data.id)}}},[t._v(" 视频 ")])]):t._e()]):t._e()],2)]:t._e()],2),1===t.data.textTalkingSwitch||1===t.data.attachmentTalkingSwitch||1===t.data.questionTalkingSwitch?n("a-button",{attrs:{type:"primary",icon:"question-circle",size:"small"}},[t._v(" 讨论区 ")]):t._e(),n("a-modal",{attrs:{width:870,title:"内容修改"},on:{ok:t.changeText},model:{value:t.textModal,callback:function(e){t.textModal=e},expression:"textModal"}},[0===t.courseSelectedItemData.contentType?n("Editor",{ref:"editor",attrs:{defaultHtml:t.data.textContent}}):t._e(),1===t.courseSelectedItemData.contentType?n("a-input",{attrs:{placeholder:"请输入文件名称"},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}}):t._e()],1),n("RecordQuestions",{ref:"questionsModal",attrs:{isEditing:"",data:t.data}})],1)},i=[],s=(n(69418),n(26490)),o=n(35462),c={name:"ContentQuestion",components:{Editor:()=>n.e(7415).then(n.bind(n,17415)),RecordQuestions:()=>n.e(7930).then(n.bind(n,87930))},props:{contentType:{type:Number,required:!0},data:{type:Object,required:!0}},data(){return{textModal:!1,fileName:"",relationArr:[]}},computed:{isNoChecking(){return!["0","1","2","3"].includes(this.editorType)},index(){return this.contentData.findIndex((t=>t.content.id===this.data.id))},...(0,s.rn)({courseId:t=>t.c.courseId,courseContentId:t=>t.c.courseContentId,isOtherTeacher:t=>t.c.isOtherTeacher,showAnswerArea:t=>t.c.showAnswerArea,contentData:t=>t.c.contentData,editorType:t=>t.c.selectItem.editorType,relationData:t=>t.c.selectItem.relationData,contentCheckedArr:t=>t.c.contentCheckedArr}),...(0,s.Se)("c",["courseSelectedItemData"])},methods:{...(0,s.nv)("c",["changeEditorType","changeContentCheckedArr","changeRelationData","getCourseTagAttrData"]),...(0,s.OI)("c",["changeCourseContentId","replaceContent"]),changeScore(t){(0,o._P)([{id:this.data.id,questionScore:t}]).then((e=>{if(e.extra){let e=this.contentData.findIndex((t=>t.content.id===this.data.id));this.contentData[e].content.questionScore=t,this.replaceContent(this.contentData)}}))},checkRelation(){let t=this.contentData.slice(this.index).findIndex((t=>2!==t.contentType));-1===t?this.changeRelationData(this.contentData.slice(this.index).map((t=>t.content.id))):this.changeRelationData(this.contentData.slice(this.index).slice(0,t).map((t=>t.content.id)))},questionClick(){this.courseContentId!==this.data.id&&this.isNoChecking?(this.checkRelation(),this.changeCourseContentId(this.data.id)):this.changeCourseContentId("")},menuClick(t){const e=this;let n,{id:a,relation:i,quesNum:s}=this.data;switch(n=i&&i.length>0?this.contentData.map((t=>{if(i.includes(t.id))return t.quesNum})).filter((t=>t)).toString():s,t){case-1:this.changeEditorType("");let s=this.contentData.findIndex((t=>t.content.id===this.courseContentId)),c=this.contentData[s].content.mappingIdList;(0,o.N6)(this.contentData[s].content.firstQuestionId).then((()=>{this.contentData.map((t=>{c.includes(t.content.id)&&(t.content.firstQuestionId=null,t.content.mappingIdList=[])})),this.replaceContent(this.contentData)}));break;case"0":this.changeEditorType(t);break;case"1":this.changeEditorType(t);break;case"2":this.changeEditorType(t);break;case"3":this.changeEditorType(t);break;case"4":this.changeEditorType(t);break;case"5":this.changeEditorType(t);break;case"6":this.changeEditorType(t),this.$confirm({title:"是否确定要删除?",content:2===this.contentType&&i&&i.length>0?`点击删除将会删除题号为 ${n} 的内容`:"点击删除将会删除所选内容",okText:"删除",maskClosable:!0,okType:"danger",cancelText:"取消",onOk:()=>{if(0===e.contentType)(0,o.eP)([a],e.courseId).then((()=>{e.replaceContent(e.contentData.filter((t=>t.content.id!==a))),e.getCourseTagAttrData(e.courseId),e.changeCourseContentId("")}));else if(1===e.contentType)(0,o.p_)([a],e.courseId).then((()=>{e.replaceContent(e.contentData.filter((t=>t.content.id!==a))),e.getCourseTagAttrData(e.courseId),e.changeCourseContentId("")}));else if(2===e.contentType){let t=this.courseSelectedItemData.content.mappingIdList;t.length>0?(0,o.pH)(t).then((()=>{e.replaceContent(e.contentData.filter((e=>!t.includes(e.content.id)))),e.getCourseTagAttrData(e.courseId),e.changeCourseContentId("")})):(0,o.pH)([a]).then((()=>{e.replaceContent(e.contentData.filter((t=>t.content.id!==a))),e.getCourseTagAttrData(e.courseId),e.changeCourseContentId("")}))}},onCancel:()=>{console.log("Cancel")}});break;case"7":this.changeEditorType(t),0===this.contentType&&(this.textModal=!0),1===this.contentType&&(this.textModal=!0,this.fileName=this.courseSelectedItemData.content.attachmentName),2===this.contentType&&(this.$refs.questionsModal.showModal=!0,this.$nextTick((()=>{const{questionType:t,questionStem:e,questionAnalysis:n,chooseZoneCounts:a,answerCard:i,answer:s}=this.courseSelectedItemData.content;this.$refs.questionsModal.tabIndex=t;let o=[];for(let c=0;c<a;c++)0===t?o.push({id:c,items:i.split(","),answerArr:s.split(",")[c]}):1===t&&o.push({id:c,items:i.split(","),answerArr:s.includes(",")?s.split(",")[c].split(""):s.split("")});this.$refs.questionsModal.answerData=o,this.$refs.questionsModal.itemNumber=i.split(",").length,this.$refs.questionsModal.setQuestionStem(e),this.$refs.questionsModal.setQuestionAnalysis(n)})));break}},relationChange(t,e){let n=this.relationData.findIndex((t=>t===e));this.changeContentCheckedArr(this.relationData.slice(0,n+1))},numberChange(){let t=this.contentData.map(((t,e)=>{if(2===t.contentType&&e<=this.index)return t.content.id})).filter((t=>t));this.changeContentCheckedArr(t)},checkContent(t){if(t.target.checked)this.changeContentCheckedArr([...this.contentCheckedArr,this.data.id]);else{let t=this.contentCheckedArr.filter((t=>t!==this.data.id));this.changeContentCheckedArr(t)}},changeText(){const t=this,{contentType:e}=this.courseSelectedItemData;if(0===e){if(this.$refs.editor.editor.isEmpty())return void this.$message.warn("内容不能为空！");this.$confirm({title:"是否确定修改内容?",okText:"确定",maskClosable:!0,cancelText:"取消",onOk:()=>{(0,o.l0)({id:t.data.id,textContent:t.$refs.editor.editor.getHtml()}).then((()=>{let e=this.contentData.findIndex((t=>t.content.id===this.data.id));this.contentData[e].content.textContent=t.$refs.editor.editor.getHtml(),t.replaceContent([...t.contentData]),t.textModal=!1}))},onCancel:()=>{}})}else if(1===e){if(""===this.fileName.trim())return void this.$message.warn("内容不能为空！");this.$confirm({title:"是否确定修改内容?",okText:"确定",maskClosable:!0,onOk:()=>{(0,o.iJ)({id:t.data.id,attachmentName:t.fileName}).then((()=>{let e=this.contentData.findIndex((t=>t.content.id===this.data.id));this.contentData[e].content.attachmentName=t.fileName,t.replaceContent(t.contentData),t.textModal=!1}))},onCancel:()=>{}})}else 2===e&&alert(112)},getFileIcon(t){switch(t){case".mp3":return"play-square";case".pdf":return"file-pdf";case".doc":return"file-word";default:return"file-unknown"}},changeAnswerType(t,e){let n=this.contentData.findIndex((t=>t.content.id===e));0===t?(0,o.XK)({id:e,answerWayPhoto:1===this.data.answerWayPhoto?0:1}).then((()=>{this.contentData[n].content.answerWayPhoto=1===this.data.answerWayPhoto?0:1,this.replaceContent(this.contentData)})):1===t?(0,o.XK)({id:e,answerWayHandle:1===this.data.answerWayHandle?0:1}).then((()=>{this.contentData[n].content.answerWayHandle=1===this.data.answerWayHandle?0:1,this.replaceContent(this.contentData)})):2===t?(0,o.XK)({id:e,answerWayTalking:1===this.data.answerWayTalking?0:1}).then((()=>{this.contentData[n].content.answerWayTalking=1===this.data.answerWayTalking?0:1,this.replaceContent(this.contentData)})):3===t&&(0,o.XK)({id:e,answerWayVideo:1===this.data.answerWayVideo?0:1}).then((()=>{this.contentData[n].content.answerWayVideo=1===this.data.answerWayVideo?0:1,this.replaceContent(this.contentData)}))}}},r=c,d=n(35471),l=(0,d.Z)(r,a,i,!1,null,"2affa3e3",null),h=l.exports}}]);