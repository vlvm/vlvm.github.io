"use strict";(self["webpackChunkteacher_project"]=self["webpackChunkteacher_project"]||[]).push([[3134],{23134:function(t,e,n){n.r(e),n.d(e,{default:function(){return f}});var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"quesContent",class:{active:t.courseContentId===t.data.id&&t.isNoChecking,important:(1===t.data.pointSwitch||1===t.data.mustHandleSwitch)&&2!==t.data.type},on:{click:t.questionClick}},[n("ul",{directives:[{name:"show",rawName:"v-show",value:t.courseContentId===t.data.id&&t.isNoChecking&&!t.isOtherTeacher,expression:"courseContentId === data.id && isNoChecking && !isOtherTeacher"}]},[2===t.contentType?[null!==t.data.firstQuestionId?n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick(-1)}}},[t._v(" 取消关联 ")]):t._e(),t.relationData.length>1&&null===t.data.firstQuestionId?n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("0")}}},[t._v(" 多题关联 ")]):t._e(),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("1")}}},[t._v("连续编号")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("2")}}},[t._v("连续设分")])]:t._e(),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("3")}}},[t._v("多选")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("4")}}},[t._v("拷贝")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("5")}}},[t._v("粘贴")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("6")}}},[t._v("删除")]),n("li",{on:{click:function(e){return e.stopPropagation(),t.menuClick("7")}}},[t._v("编辑")])],2),n("div",{staticClass:"item"},["0"===t.editorType&&t.relationData.includes(t.data.id)&&null===t.data.firstQuestionId?n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:function(e){return t.relationChange(e,t.data.id)}}}):t._e(),2!==t.contentType||"1"!==t.editorType&&"2"!==t.editorType?t._e():n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:t.numberChange}}),"3"===t.editorType?n("a-checkbox",{attrs:{lable:"",value:t.data.id,checked:t.contentCheckedArr.includes(t.data.id)},on:{change:function(e){return t.checkContent(e)}}}):t._e(),0===t.contentType&&0!==t.data.titleLevel?n("a-icon",{attrs:{type:"caret-down"}}):t._e(),0===t.contentType?n("div",{staticClass:"txt",domProps:{innerHTML:t._s(t.data.textContent)}}):t._e(),1===t.contentType?n("div",{staticClass:"file"},[n("a-icon",{style:{fontSize:"32px",color:"#3E8AF9",marginRight:"10px"},attrs:{type:t.getFileIcon(t.data.attachmentExtraName)}}),n("a",{attrs:{href:"/exam/"+t.data.attachmentLinkAddress}},[t._v(" "+t._s(t.data.attachmentName)+" ")])],1):t._e(),2===t.contentType?[n("div",{staticClass:"itemContent"},[n("div",{staticStyle:{display:"flex","justify-content":"flex-start","align-items":"center","margin-bottom":"5px"},on:{click:function(t){t.stopPropagation()}}},[n("a-tag",[t._v("题号："+t._s(t.data.questionNumber))]),n("span",[t._v("分数：")]),n("a-input-number",{staticStyle:{width:"50px",height:"22px","line-height":"22px","margin-right":"10px"},attrs:{size:"small",min:1,max:1e5,value:t.data.questionScore,disabled:2===t.contentType&&("1"===t.editorType||"2"===t.editorType)},on:{change:t.changeScore}}),1===t.data.mustDoSwitch?n("a-tag",{attrs:{color:"#FF9933"}},[t._v("必做")]):t._e(),1===t.data.selfReadOverSwitch?n("a-tag",{attrs:{color:"#FF9933"}},[t._v(" 自阅 ")]):t._e(),null!==t.data.firstQuestionId?n("a-tag",{attrs:{color:"#FF9933"}},[n("span",{staticClass:"iconfont lx-guanlian",staticStyle:{color:"#fff"}})]):t._e()],1),2!==t.showAnswerArea?[n("div",{staticClass:"txt",domProps:{innerHTML:t._s(t.data.questionStem)}}),t.courseContentId===t.data.id?[n("div",{staticClass:"rightAnswer"},[n("div",[t._v("答案：")]),n("div",{staticClass:"questionAnswer",domProps:{innerHTML:t._s(t.data.answer)}})]),n("div",{staticClass:"analysis"},[n("div",[t._v("解析：")]),n("div",{staticClass:"questionAnalysis",domProps:{innerHTML:t._s(t.data.questionAnalysis)}})])]:t._e()]:t._e(),0===t.data.questionType?t._l(t.data.chooseZoneCounts,(function(e){return n("div",{key:e,staticStyle:{display:"flex","align-items":"center"}},[1===t.showAnswerArea||2===t.showAnswerArea?n("span",[t._v(t._s(e)+".")]):t._e(),1===t.showAnswerArea||2===t.showAnswerArea?n("ol",{staticClass:"singleChoice"},t._l(t.data.answerCard.split(","),(function(e){return n("li",{key:e},[t._v(" "+t._s(e)+" ")])})),0):t._e()])})):t._e(),[2,3].includes(t.data.questionType)?n("div",[1===t.showAnswerArea||2===t.showAnswerArea?n("ol",{staticClass:"singleChoice",on:{click:function(t){t.stopPropagation()}}},[n("li",{class:{answerWayActive:1===t.data.answerWayPhoto},on:{click:function(e){return t.changeAnswerType(0,t.data.id)}}},[t._v(" 拍照 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayHandle},on:{click:function(e){return t.changeAnswerType(1,t.data.id)}}},[t._v(" 手写 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayTalking},on:{click:function(e){return t.changeAnswerType(2,t.data.id)}}},[t._v(" 音频 ")]),n("li",{class:{answerWayActive:1===t.data.answerWayVideo},on:{click:function(e){return t.changeAnswerType(3,t.data.id)}}},[t._v(" 视频 ")])]):t._e()]):t._e()],2)]:t._e()],2),1===t.data.textTalkingSwitch||1===t.data.attachmentTalkingSwitch||1===t.data.questionTalkingSwitch?n("a-button",{attrs:{type:"primary",icon:"question-circle",size:"small"}},[t._v(" 讨论区 ")]):t._e(),n("a-modal",{attrs:{width:870,title:"内容修改"},on:{ok:t.changeText},model:{value:t.textModal,callback:function(e){t.textModal=e},expression:"textModal"}},[0===t.courseSelectedItemData.contentType?n("Editor",{ref:"editor",attrs:{defaultHtml:t.data.textContent}}):t._e(),1===t.courseSelectedItemData.contentType?n("a-input",{attrs:{placeholder:"请输入文件名称"},model:{value:t.fileName,callback:function(e){t.fileName=e},expression:"fileName"}}):t._e()],1),n("RecordQuestions",{ref:"questionsModal",attrs:{isEditing:"",data:t.data}})],1)},i=[],o=n(87115),c=n(7204),r=(n(21206),n(68428),n(58742),n(91644),n(69418),n(52892),n(3242),n(99258),n(54779),n(66359),n(13176),n(70444),n(3111),n(8700),n(49538),n(26490)),s=n(35462),d={name:"ContentQuestion",components:{Editor:function(){return n.e(7658).then(n.bind(n,57658))},RecordQuestions:function(){return n.e(7930).then(n.bind(n,87930))}},props:{contentType:{type:Number,required:!0},data:{type:Object,required:!0}},data:function(){return{textModal:!1,fileName:"",relationArr:[]}},computed:(0,c.Z)((0,c.Z)({isNoChecking:function(){return!["0","1","2","3"].includes(this.editorType)},index:function(){var t=this;return this.contentData.findIndex((function(e){return e.content.id===t.data.id}))}},(0,r.rn)({courseId:function(t){return t.c.courseId},courseContentId:function(t){return t.c.courseContentId},isOtherTeacher:function(t){return t.c.isOtherTeacher},showAnswerArea:function(t){return t.c.showAnswerArea},contentData:function(t){return t.c.contentData},editorType:function(t){return t.c.selectItem.editorType},relationData:function(t){return t.c.selectItem.relationData},contentCheckedArr:function(t){return t.c.contentCheckedArr}})),(0,r.Se)("c",["courseSelectedItemData"])),methods:(0,c.Z)((0,c.Z)((0,c.Z)({},(0,r.nv)("c",["changeEditorType","changeContentCheckedArr","changeRelationData","getCourseTagAttrData"])),(0,r.OI)("c",["changeCourseContentId","replaceContent"])),{},{changeScore:function(t){var e=this;(0,s._P)([{id:this.data.id,questionScore:t}]).then((function(n){if(n.extra){var a=e.contentData.findIndex((function(t){return t.content.id===e.data.id}));e.contentData[a].content.questionScore=t,e.replaceContent(e.contentData)}}))},checkRelation:function(){var t=this.contentData.slice(this.index).findIndex((function(t){return 2!==t.contentType}));-1===t?this.changeRelationData(this.contentData.slice(this.index).map((function(t){return t.content.id}))):this.changeRelationData(this.contentData.slice(this.index).slice(0,t).map((function(t){return t.content.id})))},questionClick:function(){this.courseContentId!==this.data.id&&this.isNoChecking?(this.checkRelation(),this.changeCourseContentId(this.data.id)):this.changeCourseContentId("")},menuClick:function(t){var e,n=this,a=this,i=this.data,o=i.id,c=i.relation,r=i.quesNum;switch(e=c&&c.length>0?this.contentData.map((function(t){if(c.includes(t.id))return t.quesNum})).filter((function(t){return t})).toString():r,t){case-1:this.changeEditorType("");var d=this.contentData.findIndex((function(t){return t.content.id===n.courseContentId})),l=this.contentData[d].content.mappingIdList;(0,s.N6)(this.contentData[d].content.firstQuestionId).then((function(){n.contentData.map((function(t){l.includes(t.content.id)&&(t.content.firstQuestionId=null,t.content.mappingIdList=[])})),n.replaceContent(n.contentData)}));break;case"0":this.changeEditorType(t);break;case"1":this.changeEditorType(t);break;case"2":this.changeEditorType(t);break;case"3":this.changeEditorType(t);break;case"4":this.changeEditorType(t);break;case"5":this.changeEditorType(t);break;case"6":this.changeEditorType(t),this.$confirm({title:"是否确定要删除?",content:2===this.contentType&&c&&c.length>0?"点击删除将会删除题号为 ".concat(e," 的内容"):"点击删除将会删除所选内容",okText:"删除",maskClosable:!0,okType:"danger",cancelText:"取消",onOk:function(){if(0===a.contentType)(0,s.eP)([o],a.courseId).then((function(){a.replaceContent(a.contentData.filter((function(t){return t.content.id!==o}))),a.getCourseTagAttrData(a.courseId),a.changeCourseContentId("")}));else if(1===a.contentType)(0,s.p_)([o],a.courseId).then((function(){a.replaceContent(a.contentData.filter((function(t){return t.content.id!==o}))),a.getCourseTagAttrData(a.courseId),a.changeCourseContentId("")}));else if(2===a.contentType){var t=n.courseSelectedItemData.content.mappingIdList;t.length>0?(0,s.pH)(t).then((function(){a.replaceContent(a.contentData.filter((function(e){return!t.includes(e.content.id)}))),a.getCourseTagAttrData(a.courseId),a.changeCourseContentId("")})):(0,s.pH)([o]).then((function(){a.replaceContent(a.contentData.filter((function(t){return t.content.id!==o}))),a.getCourseTagAttrData(a.courseId),a.changeCourseContentId("")}))}},onCancel:function(){console.log("Cancel")}});break;case"7":this.changeEditorType(t),0===this.contentType&&(this.textModal=!0),1===this.contentType&&(this.textModal=!0,this.fileName=this.courseSelectedItemData.content.attachmentName),2===this.contentType&&(this.$refs.questionsModal.showModal=!0,this.$nextTick((function(){var t=n.courseSelectedItemData.content,e=t.questionType,a=t.questionStem,i=t.questionAnalysis,o=t.chooseZoneCounts,c=t.answerCard,r=t.answer;n.$refs.questionsModal.tabIndex=e;for(var s=[],d=0;d<o;d++)0===e?s.push({id:d,items:c.split(","),answerArr:r.split(",")[d]}):1===e&&s.push({id:d,items:c.split(","),answerArr:r.includes(",")?r.split(",")[d].split(""):r.split("")});n.$refs.questionsModal.answerData=s,n.$refs.questionsModal.itemNumber=c.split(",").length,n.$refs.questionsModal.setQuestionStem(a),n.$refs.questionsModal.setQuestionAnalysis(i)})));break}},relationChange:function(t,e){var n=this.relationData.findIndex((function(t){return t===e}));this.changeContentCheckedArr(this.relationData.slice(0,n+1))},numberChange:function(){var t=this,e=this.contentData.map((function(e,n){if(2===e.contentType&&n<=t.index)return e.content.id})).filter((function(t){return t}));this.changeContentCheckedArr(e)},checkContent:function(t){var e=this;if(t.target.checked)this.changeContentCheckedArr([].concat((0,o.Z)(this.contentCheckedArr),[this.data.id]));else{var n=this.contentCheckedArr.filter((function(t){return t!==e.data.id}));this.changeContentCheckedArr(n)}},changeText:function(){var t=this,e=this,n=this.courseSelectedItemData.contentType;if(0===n){if(this.$refs.editor.editor.isEmpty())return void this.$message.warn("内容不能为空！");this.$confirm({title:"是否确定修改内容?",okText:"确定",maskClosable:!0,cancelText:"取消",onOk:function(){(0,s.l0)({id:e.data.id,textContent:e.$refs.editor.editor.getHtml()}).then((function(){var n=t.contentData.findIndex((function(e){return e.content.id===t.data.id}));t.contentData[n].content.textContent=e.$refs.editor.editor.getHtml(),e.replaceContent((0,o.Z)(e.contentData)),e.textModal=!1}))},onCancel:function(){}})}else if(1===n){if(""===this.fileName.trim())return void this.$message.warn("内容不能为空！");this.$confirm({title:"是否确定修改内容?",okText:"确定",maskClosable:!0,onOk:function(){(0,s.iJ)({id:e.data.id,attachmentName:e.fileName}).then((function(){var n=t.contentData.findIndex((function(e){return e.content.id===t.data.id}));t.contentData[n].content.attachmentName=e.fileName,e.replaceContent(e.contentData),e.textModal=!1}))},onCancel:function(){}})}else 2===n&&alert(112)},getFileIcon:function(t){switch(t){case".mp3":return"play-square";case".pdf":return"file-pdf";case".doc":return"file-word";default:return"file-unknown"}},changeAnswerType:function(t,e){var n=this,a=this.contentData.findIndex((function(t){return t.content.id===e}));0===t?(0,s.XK)({id:e,answerWayPhoto:1===this.data.answerWayPhoto?0:1}).then((function(){n.contentData[a].content.answerWayPhoto=1===n.data.answerWayPhoto?0:1,n.replaceContent(n.contentData)})):1===t?(0,s.XK)({id:e,answerWayHandle:1===this.data.answerWayHandle?0:1}).then((function(){n.contentData[a].content.answerWayHandle=1===n.data.answerWayHandle?0:1,n.replaceContent(n.contentData)})):2===t?(0,s.XK)({id:e,answerWayTalking:1===this.data.answerWayTalking?0:1}).then((function(){n.contentData[a].content.answerWayTalking=1===n.data.answerWayTalking?0:1,n.replaceContent(n.contentData)})):3===t&&(0,s.XK)({id:e,answerWayVideo:1===this.data.answerWayVideo?0:1}).then((function(){n.contentData[a].content.answerWayVideo=1===n.data.answerWayVideo?0:1,n.replaceContent(n.contentData)}))}})},l=d,u=n(35471),h=(0,u.Z)(l,a,i,!1,null,"2affa3e3",null),f=h.exports}}]);