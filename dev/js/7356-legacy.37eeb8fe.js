"use strict";(self["webpackChunkteacher_project"]=self["webpackChunkteacher_project"]||[]).push([[7356],{50769:function(t,e,a){a.r(e),a.d(e,{default:function(){return f}});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative"}},[a("div",{class:{noRoot:2===t.role},staticStyle:{padding:"5px",height:"calc(100vh - 120px)"}},[a("CatalogueTree",{attrs:{list:t.catalogueList},on:{catalogClick:t.catalogClick,rightClick:t.rightClick}})],1),0!==t.position.x||0!==t.position.y?a("ul",{staticClass:"menu",style:{left:t.position.x+"px",top:t.position.y+"px"}},[a("li",{on:{click:t.addCatalogue}},[t._v("添加子目录")]),2!==t.catalogueData.catalogParentId?[a("li",{on:{click:t.openChangeNameModal}},[t._v("重命名")]),a("li",{on:{click:t.delCatalogue}},[t._v("删除")]),a("li",{on:{click:t.copyCatalogue}},[t._v("创建副本")]),a("li",[t._v("移动到")])]:t._e()],2):t._e(),a("a-modal",{attrs:{title:"重命名目录"},on:{ok:t.rename},model:{value:t.catalogueNameModal,callback:function(e){t.catalogueNameModal=e},expression:"catalogueNameModal"}},[a("a-input",{attrs:{placeholder:"请输入目录名称"},model:{value:t.catalogName,callback:function(e){t.catalogName=e},expression:"catalogName"}})],1)],1)},n=[],i=a(7204),c=(a(21206),a(68428),a(58742),a(70444),a(87830),a(57757),a(26490)),l=a(95179),s=a.n(l),r=a(1481),u=a(35462),g={name:"MytTree",components:{CatalogueTree:function(){return a.e(3897).then(a.bind(a,3897))}},data:function(){return{catalogueNameModal:!1,catalogName:"",position:{x:0,y:0},catalogueData:{}}},computed:(0,i.Z)({},(0,c.rn)({role:function(t){return t.role},catalogueList:function(t){return t.catalogueList},isOtherTeacher:function(t){return t.c.isOtherTeacher},courseId:function(t){return t.c.courseId},courseContentId:function(t){return t.c.courseContentId},contentData:function(t){return t.c.contentData}})),mounted:function(){document.addEventListener("click",this.bodyCloseMenus)},beforeDestroy:function(){document.removeEventListener("click",this.bodyCloseMenus)},methods:(0,i.Z)((0,i.Z)((0,i.Z)((0,i.Z)({},(0,c.OI)({setCatalogueList:"setCatalogueList"})),(0,c.OI)("c",["setCourseId","changeCourseContentId","replaceContent"])),(0,c.nv)("c",["getCourseListData","getCourseTagAttrData"])),{},{loop:function(t,e,a){for(var o=0;o<t.length;o++){if(t[o].id===e)return a(t[o],o,t);t[o].childList&&this.loop(t[o].childList,e,a)}},bodyCloseMenus:function(){this.position={x:0,y:0}},catalogClick:function(t){var e=this;this.catalogueData=t,this.changeCourseContentId(""),t.id!=this.$route.query.catalogId&&(this.getCourseListData(t.id).then((function(t){t.extra.length>0?(e.setCourseId(t.extra[0].id),(0,u.vz)(t.extra[0].id).then((function(a){e.replaceContent(a.extra),a.extra.length>0&&e.getCourseTagAttrData(t.extra[0].id)}))):(e.setCourseId(""),e.replaceContent([]))})),this.$router.replace({query:s()(this.$route.query,{catalogId:t.id})}))},rightClick:function(t,e){var a=this;this.changeCourseContentId(""),this.position=t,this.catalogueData=e,e.id!=this.$route.query.catalogId&&(this.getCourseListData(e.id).then((function(t){t.extra.length>0?(a.setCourseId(t.extra[0].id),(0,u.vz)(t.extra[0].id).then((function(e){a.replaceContent(e.extra),e.extra.length>0&&a.getCourseTagAttrData(t.extra[0].id)}))):(a.setCourseId(""),a.replaceContent([]))})),this.$router.replace({query:s()(this.$route.query,{catalogId:e.id})}))},openChangeNameModal:function(){this.catalogueNameModal=!0,this.catalogName=this.catalogueData.catalogName},rename:function(){var t=this,e=this.catalogueData.id;if(0===this.catalogName.length)return this.$error({title:"目录名称不能为空！",content:"请检查目录并输入目录名称"}),!1;(0,r.PQ)({id:e,catalogName:this.catalogName}).then((function(a){a.extra?(t.loop(t.catalogueList,e,(function(e){e.catalogName=t.catalogName})),t.setCatalogueList(t.catalogueList),t.$message.success("修改成功")):t.$message.error("修改失败！"),t.catalogueNameModal=!1}))},delCatalogue:function(){var t=this,e=this.catalogueData,a=e.id,o=e.catalogName;this.$confirm({title:"确认删除目录【".concat(o,"】吗？"),onOk:function(){(0,r._v)([a]).then((function(e){e.extra&&(t.loop(t.catalogueList,a,(function(t,e,a){a.splice(e,1)})),t.setCatalogueList(t.catalogueList),t.$router.replace({query:s()(t.$route.query,{catalogId:""})}),t.replaceContent([]),t.$store.commit("c/setCourseId",""),t.$store.commit("c/setCourseList",[]),t.$message.success("已删除"))}))},onCancel:function(){console.log("Cancel")}})},addCatalogue:function(){var t=this,e=this.catalogueData,a=e.id,o=e.catalogIdPath,n=e.catalogParentId;(0,r.kJ)({pid:a,catalogName:"新建目录",catalogParentId:n,classify:this.role,catalogIndex:1,catalogIdPath:o}).then((function(e){t.loop(t.catalogueList,a,(function(t){t.childList||(t.childList=[]),t.childList.push(e.extra)})),t.setCatalogueList(t.catalogueList)}))},copyCatalogue:function(){var t=this,e=this.catalogueData,a=e.id,o=e.catalogName;(0,r.Uv)({id:a,catalogName:"".concat(o,"-副本")}).then((function(e){e.extra&&(t.loop(t.catalogueList,a,(function(t,a,o){o.push(e.extra)})),t.setCatalogueList(t.catalogueList))}))}})},d=g,h=a(35471),C=(0,h.Z)(d,o,n,!1,null,"6f9686da",null),f=C.exports}}]);