"use strict";(self["webpackChunkteacher_project"]=self["webpackChunkteacher_project"]||[]).push([[6564],{96564:function(e,t,n){n.r(t),n.d(t,{default:function(){return m}});var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"center"},[1===e.role?n("Tab",{staticStyle:{"margin-bottom":"10px"},attrs:{tabIndex:e.tabIndex,"tab-data":[{id:"0",name:"创建课程"},{id:"1",name:"处理课程"},{id:"2",name:"课程结果"}]},on:{changeIndex:e.changeIndex}}):e._e(),n("div",{staticClass:"tabs"},[n("div",{staticClass:"swiper_box",style:{width:e.isOtherTeacher?"100%":"770px"}},[e.courseList.length>4?n("a-icon",{staticStyle:{"font-size":"16px"},attrs:{type:"left"},on:{click:e.slidePrev}}):e._e(),n("swiper",{ref:"mySwiper",staticClass:"swiper",style:{width:e.isOtherTeacher?"800px":"700px"},attrs:{options:e.swiperOption}},e._l(e.courseList,(function(t,o){return n("swiper-slide",{key:t.id,class:{sideActive:e.courseId===t.id}},[e.courseList.length>0?n("div",{staticClass:"courseName"},[n("a-tooltip",{attrs:{placement:"bottomLeft",title:""+t.courseName}},[e._v(" "+e._s(t.courseName)+" ")])],1):e._e(),e.isOtherTeacher?e._e():n("div",[n("a-dropdown",{attrs:{trigger:["click"]}},[n("a-icon",{attrs:{type:"more"},on:{click:function(e){return e.stopPropagation()}}}),n("a-menu",{attrs:{slot:"overlay"},on:{click:function(n){return e.dropdownClick(n,t)}},slot:"overlay"},[n("a-menu-item",{key:"0"},[n("a-icon",{attrs:{type:"edit"}}),e._v(" 重命名 ")],1),e.courseList.length>1?[0!==o?n("a-menu-item",{key:"1"},[n("a-icon",{attrs:{type:"menu-fold"}}),e._v(" 左移 ")],1):e._e(),o<e.courseList.length-1?n("a-menu-item",{key:"2"},[n("a-icon",{attrs:{type:"menu-unfold"}}),e._v(" 右移 ")],1):e._e()]:e._e(),n("a-menu-item",{key:"3"},[n("a-icon",{attrs:{type:"scissor"}}),e._v(" 复制到 ")],1),n("a-menu-item",{key:"4"},[n("a-icon",{attrs:{type:"copy"}}),e._v(" 创建副本 ")],1),n("a-menu-item",{key:"5",staticStyle:{color:"red"}},[n("a-icon",{attrs:{type:"delete"}}),e._v(" 删除 ")],1)],2)],1)],1)])})),1),e.courseList.length>4?n("a-icon",{staticStyle:{"font-size":"16px"},attrs:{type:"right"},on:{click:e.slideNext}}):e._e()],1),e.isOtherTeacher?e._e():n("a-button",{on:{click:e.openCreateCourseModal}},[e._v(" 创建课程 ")])],1),n("div",{staticClass:"center_content"},[e.courseList.length>0?[n("div",{staticClass:"c_top"},[n("div",{staticClass:"btn_group_l"},[n("a-button",{attrs:{size:"small",disabled:e.isOtherTeacher||!e.canAddCourseContent},on:{click:function(t){e.modal.addContentTextModal=!0}}},[e._v(" 文字 ")]),n("a-button",{attrs:{size:"small",disabled:e.isOtherTeacher||!e.canAddCourseContent},on:{click:e.uploadFile}},[e._v(" 文件 ")]),n("a-button",{attrs:{size:"small",disabled:e.isOtherTeacher||!e.canAddCourseContent},on:{click:function(t){e.$refs.RecordQuestions.showModal=!0}}},[e._v(" 题 ")]),n("input",{ref:"fileUpload",staticStyle:{display:"none"},attrs:{type:"file",accept:".docx,.doc,.dotx,.pptx,.ppt,.potx,.pdf,.mp4,.mp3"},on:{change:function(t){return e.upload(t)}}})],1),n("div",{staticClass:"btn_group_r"},[0===e.showAnswerArea?n("a-button",{attrs:{size:"small",disabled:e.isOtherTeacher},on:{click:function(t){return e.changeAnswerArea(0)}}},[e._v(" 显示作答区域 ")]):e._e(),1===e.showAnswerArea?n("a-button",{attrs:{size:"small",type:"primary"},on:{click:function(t){return e.changeAnswerArea(1)}}},[e._v(" 隐藏作答区 ")]):e._e(),n("a-button",{attrs:{size:"small",type:e.canAddCourseContent?"":"primary"},on:{click:function(t){e.$refs.courseFilterModal.showModal=!0}}},[e._v(" 筛选 ")])],1)]),n("ContentBox",{ref:"contentBox"})]:e._e()],2),n("a-modal",{attrs:{title:0===e.nameModalType?"新建课程":"重命名课程"},model:{value:e.modal.changeNameModal,callback:function(t){e.$set(e.modal,"changeNameModal",t)},expression:"modal.changeNameModal"}},[n("a-input",{attrs:{placeholder:"请输入课程名称"},model:{value:e.courseName,callback:function(t){e.courseName=t},expression:"courseName"}}),n("template",{slot:"footer"},[n("a-button",{on:{click:function(t){e.modal.changeNameModal=!1}}},[e._v(" 取消 ")]),0===e.nameModalType?n("a-button",{attrs:{type:"primary"},on:{click:e.createdCourse}},[e._v(" 确定 ")]):e._e(),1===e.nameModalType?n("a-button",{attrs:{type:"primary"},on:{click:e.renameCourse}},[e._v(" 确定 ")]):e._e()],1)],2),n("a-modal",{attrs:{width:870,title:"添加文字"},on:{ok:e.addContentText},model:{value:e.modal.addContentTextModal,callback:function(t){e.$set(e.modal,"addContentTextModal",t)},expression:"modal.addContentTextModal"}},[n("Editor",{ref:"editor"})],1),n("RecordQuestions",{ref:"RecordQuestions"}),n("CourseFilterModal",{ref:"courseFilterModal",on:{contentFilter:e.contentFilter}})],1)},r=[],a=n(87115),s=n(7204),i=(n(21206),n(68428),n(58742),n(8700),n(52892),n(57757),n(66359),n(93521),n(13034));function c(e){var t=e.lastIndexOf("/"),n=e.lastIndexOf("\\"),o=Math.max(t,n);return o<0?e:e.substring(o+1)}var u=n(26490),d=n(35462),l={name:"SideCenter",components:{Tab:function(){return n.e(760).then(n.bind(n,60760))},swiper:i.swiper,swiperSlide:i.swiperSlide,Editor:function(){return n.e(7658).then(n.bind(n,57658))},ContentBox:function(){return Promise.all([n.e(2535),n.e(6329)]).then(n.bind(n,16329))},CourseFilterModal:function(){return n.e(8033).then(n.bind(n,78033))},RecordQuestions:function(){return n.e(7930).then(n.bind(n,87930))}},data:function(){var e=this;return{modal:{changeNameModal:!1,addContentTextModal:!1},tabIndex:"0",drag:!1,swiperOption:{allowTouchMove:!1,slidesPerView:4,spaceBetween:5,on:{tap:function(){e.setCourseId(e.courseList[e.swiper.clickedIndex].id),e.changeCourseContentId(""),e.getCourseContentById(e.courseId)}}},nameModalType:0,courseName:"",canAddCourseContent:!0}},computed:(0,s.Z)({swiper:function(){return this.$refs.mySwiper.swiper}},(0,u.rn)({role:function(e){return e.role},courseId:function(e){return e.c.courseId},courseList:function(e){return e.c.courseList},courseContentId:function(e){return e.c.courseContentId},isOtherTeacher:function(e){return e.c.isOtherTeacher},showAnswerArea:function(e){return e.c.showAnswerArea},contentData:function(e){return e.c.contentData}})),mounted:function(){},methods:(0,s.Z)((0,s.Z)((0,s.Z)({},(0,u.OI)("c",["changeCourseContentId","setCourseId","setCourseList","replaceContent"])),(0,u.nv)("c",["changeAnswerArea","getCourseListData","getCourseTagAttrData"])),{},{getCourseList:function(e){var t=this;this.getCourseListData(e).then((function(e){e.extra.length>0&&(t.setCourseId(e.extra[0].id),t.getCourseContentById(e.extra[0].id))}))},changeIndex:function(e){0!==this.courseList.length?(this.changeCourseContentId(""),this.tabIndex=e,"0"===e?this.$router.push({path:"/course/created",query:{catalogId:this.$route.query.catalogId}}):"1"===e?this.$router.push({path:"/course/processing",query:{catalogId:this.$route.query.catalogId}}):"2"===e&&this.$router.push({path:"/course/result",query:{catalogId:this.$route.query.catalogId}})):this.$warning({title:"请先创建课程！",content:"创建课程后才能查看"})},openCreateCourseModal:function(){this.$route.query.catalogId&&""!=this.$route.query.catalogId?(this.nameModalType=0,this.courseName="",this.modal.changeNameModal=!0):this.$message.warn("请先选择目录！")},createdCourse:function(){var e=this;""!==this.courseName?(0,d.P6)({courseName:this.courseName,catalogId:this.$route.query.catalogId,courseTagId:parseInt(this.role)}).then((function(t){e.setCourseList([].concat((0,a.Z)(e.courseList),[t.extra]));var n=e.courseList.length-1;e.setCourseId(e.courseList[n].id),e.swiper.slideTo(n,10,!1),e.courseName="",e.modal.changeNameModal=!1,e.getCourseContentById(e.courseId)})):this.$message.warn("请输入课程名称！")},renameCourse:function(){var e=this;(0,d.pk)({id:this.courseId,courseName:this.courseName}).then((function(t){if(t.extra){e.modal.changeNameModal=!1;var n=e.courseList.findIndex((function(t){return t.id===e.courseId}));e.courseList[n].courseName=e.courseName,e.setCourseList(e.courseList)}}))},slidePrev:function(){this.swiper.isBeginning?this.$message.warning("已经是第一个课程了！"):this.swiper.slidePrev()},slideNext:function(){this.swiper.isEnd?this.$message.warning("已经是最后一个课程了！"):this.swiper.slideNext()},dropdownClick:function(e,t){var n=this,o=this,r=e.key,a=this.courseList.findIndex((function(e){return e.id===n.courseId}));function s(e,t){0!==t?e[t]=e.splice(t-1,1,e[t])[0]:e.push(e.shift())}switch(r){case"0":this.courseName=this.courseList[a].courseName,this.nameModalType=1,this.modal.changeNameModal=!0;break;case"1":s(this.courseList,a);break;case"2":break;case"3":break;case"4":(0,d.xm)({id:t.id}).then((function(e){var o=n.courseList.findIndex((function(e){return e.id===t.id}));n.courseList.splice(o+1,0,e.extra),n.setCourseList(n.courseList),n.setCourseId(e.extra.id),n.swiper.slideTo(n.courseList.length-1,10,!1),n.getCourseContentById(n.courseId)}));break;case"5":this.$confirm({title:"是否确定要删除这个课程?",okText:"删除",okType:"danger",cancelText:"取消",onOk:function(){1===t.coursePublishTag?(0,d.A)(t.id).then((function(e){if(console.log(e),o.setCourseList(o.courseList.filter((function(e){return e.id!==t.id}))),o.courseList.length>0){var n=o.courseList.length-1;o.setCourseId(o.courseList[n].id),o.getCourseContentById(o.courseId)}})):(0,d.GW)(t.id).then((function(e){if(console.log(e),o.setCourseList(o.courseList.filter((function(e){return e.id!==t.id}))),o.courseList.length>0){var n=o.courseList.length-1;o.setCourseId(o.courseList[n].id),o.getCourseContentById(o.courseId)}}))},onCancel:function(){console.log("Cancel")}});break}},getCourseContentById:function(e){var t=this;(0,d.vz)(e).then((function(n){t.replaceContent(n.extra),t.getCourseTagAttrData(e)}))},addContentText:function(){var e=this;if(""!==this.$refs.editor.editor.isEmpty()){var t={courseId:this.courseId,textContent:this.$refs.editor.html,textIndex:this.contentData.length};if(""===this.courseContentId)(0,d.Le)(t).then((function(t){e.modal.addContentTextModal=!1,e.replaceContent([].concat((0,a.Z)(e.contentData),[t.extra])),e.$refs.editor.clear()}));else{var n=this.contentData.findIndex((function(t){return t.content.id===e.courseContentId}));if(2===this.contentData[n].contentType){var o=this.contentData[n].content.mappingIdList;if(o.length>0){var r=this.contentData.findIndex((function(e){return e.content.id===o[o.length-1]}));t.textIndex=r+2,(0,d.Le)(t).then((function(t){e.contentData.splice(r+1,0,t.extra),e.replaceContent(e.contentData),e.$refs.editor.clear(),e.modal.addContentTextModal=!1}))}return}t.textIndex=n+2,(0,d.Le)(t).then((function(t){e.contentData.splice(n+1,0,t.extra),e.replaceContent(e.contentData),e.$refs.editor.clear(),e.modal.addContentTextModal=!1}))}}else this.$message.warning("请输入文字内容！")},uploadFile:function(){this.$refs.fileUpload.click()},upload:function(e){var t=this,n=e.target.files[0];console.log(c(e.target.value)),(0,d.Ue)({uploadFile:n},this.courseId).then((function(n){if(""===t.courseContentId)t.replaceContent([].concat((0,a.Z)(t.contentData),[n.extra]));else{var o=t.contentData.findIndex((function(e){return e.content.id===t.courseContentId}));if(2===t.contentData[o].contentType){var r=t.contentData[o].content.mappingIdList;if(r.length>0){var s=t.contentData.findIndex((function(e){return e.content.id===r[r.length-1]}));t.contentData.splice(s+1,0,n.extra),t.replaceContent(t.contentData)}return void(e.target.value="")}t.contentData.splice(o+1,0,n.extra),t.replaceContent(t.contentData),e.target.value=""}}))},contentFilter:function(e){var t=this;this.canAddCourseContent=!Object.values(e).some((function(e){return e})),(0,d.wV)((0,s.Z)({courseId:this.courseId},e)).then((function(e){t.replaceContent(e.extra||[])}))}})},h=l,f=n(35471),p=(0,f.Z)(h,o,r,!1,null,"2625d13a",null),m=p.exports},97535:function(e,t,n){function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}n.d(t,{Z:function(){return o}})},87115:function(e,t,n){n.d(t,{Z:function(){return c}});var o=n(97535);function r(e){if(Array.isArray(e))return(0,o.Z)(e)}n(84788),n(23495),n(21206),n(34918),n(68428),n(58742),n(22958);function a(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}var s=n(16962);n(90083);function i(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e){return r(e)||a(e)||(0,s.Z)(e)||i()}},16962:function(e,t,n){n.d(t,{Z:function(){return r}});n(3242),n(21206),n(97613),n(22958),n(68428),n(70444),n(73889);var o=n(97535);function r(e,t){if(e){if("string"===typeof e)return(0,o.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?(0,o.Z)(e,t):void 0}}}}]);