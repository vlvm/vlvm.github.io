"use strict";(self["webpackChunkteacher_project"]=self["webpackChunkteacher_project"]||[]).push([[7356],{50769:function(t,e,a){a.r(e),a.d(e,{default:function(){return C}});var o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{position:"relative"}},[a("div",{class:{noRoot:2===t.role},staticStyle:{padding:"5px",height:"calc(100vh - 120px)"}},[a("CatalogueTree",{attrs:{list:t.catalogueList},on:{catalogClick:t.catalogClick,rightClick:t.rightClick}})],1),0!==t.position.x||0!==t.position.y?a("ul",{staticClass:"menu",style:{left:t.position.x+"px",top:t.position.y+"px"}},[a("li",{on:{click:t.addCatalogue}},[t._v("添加子目录")]),2!==t.catalogueData.catalogParentId?[a("li",{on:{click:t.openChangeNameModal}},[t._v("重命名")]),a("li",{on:{click:t.delCatalogue}},[t._v("删除")]),a("li",{on:{click:t.copyCatalogue}},[t._v("创建副本")]),a("li",[t._v("移动到")])]:t._e()],2):t._e(),a("a-modal",{attrs:{title:"重命名目录"},on:{ok:t.rename},model:{value:t.catalogueNameModal,callback:function(e){t.catalogueNameModal=e},expression:"catalogueNameModal"}},[a("a-input",{attrs:{placeholder:"请输入目录名称"},model:{value:t.catalogName,callback:function(e){t.catalogName=e},expression:"catalogName"}})],1)],1)},s=[],i=a(26490),l=a(95179),c=a.n(l),r=a(1481),n=a(35462),u={name:"MytTree",components:{CatalogueTree:()=>a.e(3897).then(a.bind(a,3897))},data(){return{catalogueNameModal:!1,catalogName:"",position:{x:0,y:0},catalogueData:{}}},computed:{...(0,i.rn)({role:t=>t.role,catalogueList:t=>t.catalogueList,isOtherTeacher:t=>t.c.isOtherTeacher,courseId:t=>t.c.courseId,courseContentId:t=>t.c.courseContentId,contentData:t=>t.c.contentData})},mounted(){document.addEventListener("click",this.bodyCloseMenus)},beforeDestroy(){document.removeEventListener("click",this.bodyCloseMenus)},methods:{...(0,i.OI)({setCatalogueList:"setCatalogueList"}),...(0,i.OI)("c",["setCourseId","changeCourseContentId","replaceContent"]),...(0,i.nv)("c",["getCourseListData","getCourseTagAttrData"]),loop(t,e,a){for(let o=0;o<t.length;o++){if(t[o].id===e)return a(t[o],o,t);t[o].childList&&this.loop(t[o].childList,e,a)}},bodyCloseMenus(){this.position={x:0,y:0}},catalogClick(t){this.catalogueData=t,this.changeCourseContentId(""),t.id!=this.$route.query.catalogId&&(this.getCourseListData(t.id).then((t=>{t.extra.length>0?(this.setCourseId(t.extra[0].id),(0,n.vz)(t.extra[0].id).then((e=>{this.replaceContent(e.extra),e.extra.length>0&&this.getCourseTagAttrData(t.extra[0].id)}))):(this.setCourseId(""),this.replaceContent([]))})),this.$router.replace({query:c()(this.$route.query,{catalogId:t.id})}))},rightClick(t,e){this.changeCourseContentId(""),this.position=t,this.catalogueData=e,e.id!=this.$route.query.catalogId&&(this.getCourseListData(e.id).then((t=>{t.extra.length>0?(this.setCourseId(t.extra[0].id),(0,n.vz)(t.extra[0].id).then((e=>{this.replaceContent(e.extra),e.extra.length>0&&this.getCourseTagAttrData(t.extra[0].id)}))):(this.setCourseId(""),this.replaceContent([]))})),this.$router.replace({query:c()(this.$route.query,{catalogId:e.id})}))},openChangeNameModal(){this.catalogueNameModal=!0,this.catalogName=this.catalogueData.catalogName},rename(){const{id:t}=this.catalogueData;if(0===this.catalogName.length)return this.$error({title:"目录名称不能为空！",content:"请检查目录并输入目录名称"}),!1;(0,r.PQ)({id:t,catalogName:this.catalogName}).then((e=>{e.extra?(this.loop(this.catalogueList,t,(t=>{t.catalogName=this.catalogName})),this.setCatalogueList(this.catalogueList),this.$message.success("修改成功")):this.$message.error("修改失败！"),this.catalogueNameModal=!1}))},delCatalogue(){const t=this,{id:e,catalogName:a}=this.catalogueData;this.$confirm({title:`确认删除目录【${a}】吗？`,onOk(){(0,r._v)([e]).then((a=>{a.extra&&(t.loop(t.catalogueList,e,((t,e,a)=>{a.splice(e,1)})),t.setCatalogueList(t.catalogueList),t.$router.replace({query:c()(t.$route.query,{catalogId:""})}),t.replaceContent([]),t.$store.commit("c/setCourseId",""),t.$store.commit("c/setCourseList",[]),t.$message.success("已删除"))}))},onCancel(){console.log("Cancel")}})},addCatalogue(){const{id:t,catalogIdPath:e,catalogParentId:a}=this.catalogueData;(0,r.kJ)({pid:t,catalogName:"新建目录",catalogParentId:a,classify:this.role,catalogIndex:1,catalogIdPath:e}).then((e=>{this.loop(this.catalogueList,t,(t=>{t.childList||(t.childList=[]),t.childList.push(e.extra)})),this.setCatalogueList(this.catalogueList)}))},copyCatalogue(){const{id:t,catalogName:e}=this.catalogueData;(0,r.Uv)({id:t,catalogName:`${e}-副本`}).then((e=>{e.extra&&(this.loop(this.catalogueList,t,((t,a,o)=>{o.push(e.extra)})),this.setCatalogueList(this.catalogueList))}))}}},h=u,g=a(35471),d=(0,g.Z)(h,o,s,!1,null,"6f9686da",null),C=d.exports}}]);