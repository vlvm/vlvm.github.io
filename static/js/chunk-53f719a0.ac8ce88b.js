(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-53f719a0"],{"0d5e":function(t,e,s){},4522:function(t,e,s){"use strict";s("6b3d")},"6b3d":function(t,e,s){},cabd:function(t,e,s){"use strict";s("0d5e")},fede:function(t,e,s){"use strict";s.r(e);s("75b5"),s("f132"),s("8133"),s("dcb2"),s("0224"),s("7276"),s("6236"),s("e54e");var a=s("7850"),n=[{title:"姓名",className:"table-tr-name",dataIndex:"name",width:100},{title:"性别",className:"table-tr",dataIndex:"sex",width:70,scopedSlots:{customRender:"sex"}},{title:"身份证号",className:"table-tr",dataIndex:"idCard"},{title:"准考证号",className:"table-tr",dataIndex:"researchNo"},{title:"毕业学校",className:"table-tr",dataIndex:"graduationSchool",width:100},{title:"指定班级",className:"table-tr",dataIndex:"appointClass",width:100,scopedSlots:{customRender:"appointClass"}},{title:"操作",className:"table-tr",scopedSlots:{customRender:"action"}}],i={name:"Designation",components:{Pagination:function(){return s.e("chunk-01b6ac80").then(s.bind(null,"e0a1"))}},data:function(){return{visible:!1,title:null,columns:n,data:[],selectData:[],newSelectData:[],selectedRowKeys:[],form:{},labelCol:{span:4},wrapperCol:{span:20},visibleBar:!1,visibleConfirm:!1,settings:{},pageNum:1,pageSize:10,totalPeop:0,spinning:!1,classList:[],that:this,percent:0,modalType:1}},computed:{checkAllBtn:function(){var t=this.selectedRowKeys.length;return 0!==t&&t===this.data.length}},methods:{next:function(){this.visibleConfirm=!0},prev:function(){this.$parent.prev()},getList:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.pageNum=e,this.spinning=!0,Object(a.b)({pageNum:this.pageNum,pageSize:this.pageSize}).then((function(e){t.data=e.data.rows,t.totalPeop=e.totalPeop,t.spinning=!1})),Object(a.d)().then((function(e){t.classList=e.data}))},getSettings:function(){var t=this;Object(a.j)().then((function(e){e.data.status=-1===e.data.divisionStrategy.indexOf("4"),t.settings=e.data}))},getStudentList:function(){var t=this;Object(a.s)().then((function(e){t.selectData=e.data,t.newSelectData=e.data}))},changePageNum:function(t,e){"next"===t?this.getList(this.pageNum+=1):"prev"===t?this.getList(this.pageNum-=1):"goTo"===t&&this.getList(e)},onSelectChange:function(t){this.selectedRowKeys=t},selectedAll:function(t){this.checkBtn=t.target.checked,t.target.checked?this.selectedRowKeys=this.data.map((function(t){return t.id})):this.selectedRowKeys=[]},deleteChange:function(t){var e=this;Object(a.h)({ids:t.id}).then((function(){e.$message.success("删除成功"),e.getList()})).catch((function(){e.$message.error("删除失败")}))},deleteMoreChange:function(){var t=this;this.selectedRowKeys.length>0&&Object(a.h)({ids:this.selectedRowKeys.toString()}).then((function(){t.$message.success("删除成功"),t.getList()})).catch((function(){t.$message.error("删除失败")}))},showModal:function(t){var e=this;this.form={},null!=t||null!=t?(this.modalType=2,Object(a.a)({id:t.id}).then((function(t){e.form=t.data,e.form.newClassId=e.form.appointClass})),this.title="编辑"):(this.modalType=1,this.title="添加指定分班"),this.visible=!0},handleSearch:function(t){if(""!=t&&null!=t&&" "!=t&&t){var e=new RegExp(t);this.newSelectData=[];for(var s=[],a=0;a<this.selectData.length;a++)(e.test(this.selectData[a].name)||e.test(this.selectData[a].idCard))&&s.push(this.selectData[a]);this.newSelectData=s}},handleOk:function(){var t=this;this.$refs.form.validate((function(e){if(e&&null!=t.form.newClassId)if(1==t.modalType)Object(a.l)({studentId:t.form.id,newClassId:t.form.newClassId}).then((function(e){t.$message.success("添加成功"),t.getList(),t.visible=!1})).catch((function(e){t.$message.error("添加失败")}));else{var s={id:t.form.id,appointClass:t.form.appointClass,newClassId:t.form.newClassId,studentId:t.form.studentId};Object(a.t)(s).then((function(e){t.$message.success("修改成功"),t.getList(),t.visible=!1})).catch((function(e){t.$message.error("修改失败")}))}else t.$message.error("请完善信息")}))},cancel:function(){this.form={}},handleOkConfirm:function(){var t=this;this.percent=0,this.visibleConfirm=!1,this.visibleBar=!0;for(var e=500,s=0;s<4;s++)e+=500,setTimeout((function(){t.percent+=20}),e);setTimeout((function(){Object(a.k)().then((function(e){t.percent+=20,t.$message.success("预分班执行成功"),t.visibleBar=!1,setTimeout((function(){t.$parent.next()}),300)})).catch((function(e){t.$message.error("预分班执行失败"),t.visibleBar=!1}))}),e+200)}},filters:{tableSex:function(t){return 1==t?"男":"女"},tableClassName:function(t,e){if(null!=t){for(var s=0;s<e.classList.length;s++)if(e.classList[s].id==t){t=e.classList[s].className+"班";break}return t}return""}},created:function(){this.getList(),this.getSettings(),this.getStudentList()}},l=(s("4522"),s("cabd"),s("cba8")),o=Object(l.a)(i,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("div",{staticClass:"content"},[s("Pagination",{attrs:{pageNum:t.pageNum,pageSize:t.pageSize,total:t.totalPeop},on:{getList:t.getList,changePageNum:t.changePageNum},scopedSlots:t._u([{key:"pagination_left",fn:function(){return[s("a-button",{staticClass:"base border",attrs:{size:"small",shape:"round"}},[s("a-checkbox",{attrs:{checked:t.checkAllBtn,indeterminate:t.selectedRowKeys.length>=1&&t.selectedRowKeys.length<t.data.length,disabled:t.settings.status},on:{change:t.selectedAll}},[t._v(" 全选 ")])],1),s("a-button",{staticClass:"base border",attrs:{size:"small",shape:"round",disabled:t.settings.status},on:{click:t.deleteMoreChange}},[t._v(" 删除 ")]),s("a-button",{staticClass:"base",attrs:{size:"small",shape:"round",disabled:t.settings.status},on:{click:function(e){return t.showModal()}}},[t._v(" 新增 ")])]},proxy:!0}])}),s("a-spin",{attrs:{tip:"数据加载中...",spinning:t.spinning,delay:100}},[s("a-table",{attrs:{"row-selection":{columnWidth:20,selectedRowKeys:t.selectedRowKeys,onChange:t.onSelectChange},columnWidth:20,columns:t.columns,"data-source":t.data,rowKey:function(t){return t.id},pagination:!1},scopedSlots:t._u([{key:"sex",fn:function(e){return[t._v(" "+t._s(t._f("tableSex")(e))+" ")]}},{key:"appointClass",fn:function(e){return[t._v(" "+t._s(t._f("tableClassName")(e,t.that))+" ")]}},{key:"action",fn:function(e,a){return[s("a-button",{staticClass:"btn-a-blue",attrs:{type:"link",disabled:t.settings.status},on:{click:function(e){return t.showModal(a)}}},[t._v(" 编辑 ")]),s("a-popconfirm",{staticClass:"popconfirm",attrs:{title:"确定要删除此条数据吗？",disabled:t.settings.status},on:{confirm:function(e){return t.deleteChange(a)}}},[s("a-button",{staticClass:"btn-a-blue btn-a-red",attrs:{type:"link",disabled:t.settings.status}},[t._v(" 删除 ")])],1)]}}])})],1),s("Pagination",{attrs:{pageNum:t.pageNum,pageSize:t.pageSize,total:t.totalPeop},on:{getList:t.getList,changePageNum:t.changePageNum}})],1),s("div",{staticClass:"steps-action"},[s("a-button",{staticClass:"base",attrs:{shape:"round"},on:{click:t.prev}},[t._v(" 上一步 ")]),s("a-button",{attrs:{type:"primary"},on:{click:t.next}},[t._v(" 执行分班 ")])],1),s("a-modal",{attrs:{title:t.title,width:690},on:{ok:t.handleOk,cancel:t.cancel},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[s("a-form-model",{ref:"form",attrs:{model:t.form,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[2==t.modalType?s("a-form-model-item",{ref:"name",attrs:{label:"学生",prop:"name",colon:!1}},[s("a-input",{attrs:{type:"text",value:t.form.name,disabled:""}})],1):t._e(),1==t.modalType?s("a-form-model-item",{ref:"name",attrs:{label:"学生",prop:"name",colon:!1}},[s("a-select",{staticClass:"search-icon",staticStyle:{width:"100%"},attrs:{"show-search":"",placeholder:"请输入姓名/机构名搜索",defaultActiveFirstOption:!1,"option-filter-prop":"children",filterOption:!1},on:{search:t.handleSearch},model:{value:t.form.id,callback:function(e){t.$set(t.form,"id",e)},expression:"form.id"}},[s("a-icon",{attrs:{slot:"suffixIcon",type:"search"},slot:"suffixIcon"}),s("a-select-opt-group",[s("span",{staticClass:"custom-option",attrs:{slot:"label"},slot:"label"},[s("span",[t._v("姓名")]),s("span",[t._v("性别")]),s("span",[t._v("身份证号")])]),t._l(t.newSelectData,(function(e,a){return a<50?s("a-select-option",{key:e.id,staticClass:"custom-option",attrs:{value:e.id,label:e.name}},[t._v(" "+t._s(e.name)+" "),s("span",[t._v(t._s(t._f("tableSex")(e.sex)))]),t._v(" "+t._s(e.idCard)+" ")]):t._e()}))],2)],1)],1):t._e(),s("a-form-model-item",{ref:"shiftResults",attrs:{label:"指定班级",prop:"shiftResults",colon:!1}},[s("a-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择班级"},model:{value:t.form.newClassId,callback:function(e){t.$set(t.form,"newClassId",e)},expression:"form.newClassId"}},t._l(t.classList,(function(e){return s("a-select-option",{key:e.id,attrs:{value:e.id}},[t._v(" "+t._s(e.className)+"班 ")])})),1)],1)],1)],1),s("a-modal",{attrs:{title:"确认分班",width:690},on:{ok:t.handleOkConfirm},model:{value:t.visibleConfirm,callback:function(e){t.visibleConfirm=e},expression:"visibleConfirm"}},[s("p",{staticStyle:{color:"#414859b3"}},[t._v("是否确认执行预分班？")])]),s("a-modal",{attrs:{title:"",width:660,closable:!1,footer:null,keyboard:!1,maskClosable:!1},model:{value:t.visibleBar,callback:function(e){t.visibleBar=e},expression:"visibleBar"}},[s("h2",{staticStyle:{"text-align":"center"}},[t._v("执行预分班中，请稍后…")]),s("a-progress",{attrs:{percent:t.percent,"show-info":!1,strokeWidth:20,strokeColor:"#6FBFDF"}}),s("div",{staticStyle:{"text-align":"center","font-size":"18px"}},[t._v(t._s(t.percent)+"%")])],1)],1)}),[],!1,null,"79c64a28",null);e.default=o.exports}}]);