(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-ed561c66"],{2231:function(t,e,o){"use strict";o("7cf4")},"7cf4":function(t,e,o){},afdb:function(t,e,o){"use strict";o.r(e);o("75b5"),o("f132"),o("8133"),o("6236"),o("4e2c"),o("e54e");var a=o("b476"),r={name:"update",components:{TitleName:function(){return o.e("chunk-e7b52ff2").then(o.bind(null,"89dd"))}},props:{},data:function(){return{labelCol:{span:3},wrapperCol:{span:17},fileList:[],loading:!1,form:{},rules:{schoolGateway:{required:!0,message:"请输入校园门户",trigger:"blur"},schoolImg:{required:!0,message:"请上传校园logo",trigger:"blur"}}}},methods:{init:function(){var t=this;Object(a.a)().then((function(e){if(null!=e.data){t.form={id:e.data.id,coordinates:e.data.longitude+","+e.data.latitude,schoolGateway:e.data.schoolGateway,schoolImg:e.data.schoolImg},t.fileList=e.data.schoolGuide.split(",");for(var o=0;o<t.fileList.length;o++)t.fileList[o]={uid:o,name:"image.png",status:"done",url:t.fileList[o]}}}))},onSubmit:function(){var t=this,e=this;this.$refs.form.validate((function(o){if(o){var r=t.form.coordinates.split(",");t.form.longitude=r[0],t.form.latitude=r[1],t.form.schoolGuide="";for(var n=0;n<t.fileList.length;n++)t.form.schoolGuide+=t.fileList[n].url,n+1<t.fileList.length&&(t.form.schoolGuide+=",");t.form.id?Object(a.c)(t.form).then((function(o){0===o.code?(e.$message.success("保存成功"),t.$router.go(-1)):e.$message.error("保存失败")})):Object(a.b)(t.form).then((function(o){0===o.code?(e.$message.success("保存成功"),t.$router.go(-1)):e.$message.error("保存失败")}))}}))},uploadPosterLogo:function(t){"uploading"!==t.file.status?"done"===t.file.status&&(this.form.schoolImg=t.file.response.data):this.loading=!0},handleChange:function(t){var e=t.fileList,o=e.length-1;null!=e[o].response&&(e[o]={name:e[o].name,status:e[o].status,uid:e[o].uid,url:e[o].response.data}),this.fileList=e}},created:function(){this.init()},mounted:function(){}},n=(o("2231"),o("cba8")),s=Object(n.a)(r,(function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{},[o("TitleName",{attrs:{titleName:"校园导览"},scopedSlots:t._u([{key:"edit",fn:function(){return[o("a-button",{attrs:{shape:"round",type:"primary"},on:{click:t.onSubmit}},[t._v(" 保存 ")])]},proxy:!0}])}),o("div",{staticClass:"content"},[o("a-form-model",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[o("a-form-model-item",{ref:"coordinates",attrs:{label:"学校坐标",prop:"coordinates"}},[o("a-input",{attrs:{placeholder:"请输入"},model:{value:t.form.coordinates,callback:function(e){t.$set(t.form,"coordinates",e)},expression:"form.coordinates"}}),o("a",{staticClass:"query-but",attrs:{href:"http://api.map.baidu.com/lbsapi/getpoint/index.html",target:"_blank"}},[t._v(" 查询坐标 ")])],1),o("a-form-model-item",{ref:"schoolImg",attrs:{label:"学校logo",prop:"schoolImg"}},[o("div",[t._v("请上传学校logo，建议上传png格式的图片")]),o("div",{staticClass:"logo"},[t.form.schoolImg?o("img",{attrs:{src:t.form.schoolImg,alt:"avatar"}}):t._e(),o("a-upload",{staticClass:"avatar-uploader",attrs:{"list-type":"picture-card",action:"https://test01.bysnt.com/welcome-report-api-local/oss/upload","show-upload-list":!1},on:{change:t.uploadPosterLogo}},[t.form.schoolImg?o("div",{staticClass:"update-logo"},[o("img",{attrs:{src:t.form.schoolImg,alt:"avatar"}})]):o("div",[o("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),o("div",{staticClass:"ant-upload-text"},[t._v(" 上传 ")])],1)])],1)]),o("a-form-model-item",{ref:"",attrs:{label:"校园指引",prop:""}},[o("div",[t._v("请上传学校平面图")]),o("a-upload",{attrs:{action:"https://test01.bysnt.com/welcome-report-api-local/oss/upload","list-type":"picture-card","file-list":t.fileList},on:{change:t.handleChange}},[t.fileList.length<3?o("div",[o("a-icon",{attrs:{type:"plus"}})],1):t._e()])],1),o("a-form-model-item",{ref:"schoolGateway",attrs:{label:"校园门户",prop:"schoolGateway"}},[o("a-input",{attrs:{placeholder:"请输入校园门户url"},model:{value:t.form.schoolGateway,callback:function(e){t.$set(t.form,"schoolGateway",e)},expression:"form.schoolGateway"}})],1)],1)],1)],1)}),[],!1,null,"7e5727cb",null);e.default=s.exports},b476:function(t,e,o){"use strict";o.d(e,"a",(function(){return c})),o.d(e,"c",(function(){return l})),o.d(e,"b",(function(){return u}));o("3b32");var a=o("b775"),r={tenantId:sessionStorage.getItem("tenantId"),orgId:sessionStorage.getItem("orgId"),garde:JSON.parse(localStorage.getItem("stuGradeId"))},n=r.orgId,s=r.garde,i="".concat(r.tenantId,"/").concat(n,"/").concat(s);function c(){return Object(a.a)({url:"/guideInfo/guideInfoInfo/".concat(i),method:"get"})}function l(t){return Object(a.a)({url:"/guideInfo/updateGuideInfo",method:"post",data:t})}function u(t){return Object(a.a)({url:"/guideInfo/insertGuideInfo/".concat(i),method:"post",data:t})}},b775:function(t,e,o){"use strict";o("75b5"),o("9188"),o("6236"),o("9c7e");var a=o("cebe"),r=o.n(a),n=o("f3e4"),s=r.a.create({baseURL:"https://test01.bysnt.com/welcome-report-api",withCredentials:!0,timeout:3e4});r.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",s.interceptors.request.use((function(t){t.method;var e=Object(n.a)();return e&&(t.headers.token=e,t.headers["Cache-Control"]="no-cache",t.headers.Pragma="no-cache"),sessionStorage.getItem("user_info")&&(t.headers.tenantId=JSON.parse(sessionStorage.getItem("user_info")).tenantId),t}),(function(t){return Promise.reject(t)})),s.interceptors.response.use((function(t){var e=Number(t.data.code);if(0===e||200===e||500===e)return t.data;switch(e){case 401:localStorage.clear(),sessionStorage.clear(),Object(n.b)(),sessionStorage.setItem("backUrl",location.pathname+location.search),location.href="https://passportss2.hseduyun.net/passport/oauth/authorize?client_id=E0D55D80AAC660E8&response_type=code&redirect_uri=http://127.0.0.1:5500/management/index";break;default:return Promise.reject(t.message||"error")}}),(function(t){return Promise.reject(t)})),e.a=s},f3e4:function(t,e,o){"use strict";o.d(e,"a",(function(){return a})),o.d(e,"c",(function(){return r})),o.d(e,"b",(function(){return n}));o("6236"),o("4e2c"),o("3ad4");function a(){return i("template_token")}function r(t){return s("template_token",t)}function n(){var t,e;(e=i(t="template_token"))&&s(t,e,-1)}function s(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r="";if(o){var n=new Date;n.setTime(n.getTime()+1e3*o),r="; expires="+n.toGMTString()}document.cookie=t+"="+e+r+(a?"; path="+a:"")}function i(t){for(var e=t+"=",o=document.cookie.split(";"),a=0;a<o.length;a++){var r=o[a].trim();if(0===r.indexOf(e))return r.substring(e.length,r.length)}return""}}}]);