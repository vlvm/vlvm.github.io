(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-a62bb9a2"],{afdb:function(e,t,o){"use strict";o.r(t);o("75b5"),o("f132"),o("8133"),o("6236"),o("4e2c"),o("e54e");var a=o("b476"),r={name:"update",components:{TitleName:function(){return o.e("chunk-e7b52ff2").then(o.bind(null,"89dd"))}},props:{},data:function(){return{labelCol:{span:3},wrapperCol:{span:17},fileList:[],loading:!1,form:{},rules:{schoolGateway:{required:!0,message:"请输入校园门户",trigger:"blur"},schoolImg:{required:!0,message:"请上传校园logo",trigger:"blur"}}}},methods:{init:function(){var e=this;Object(a.a)().then((function(t){if(null!=t.data){e.form={id:t.data.id,coordinates:t.data.longitude+","+t.data.latitude,schoolGateway:t.data.schoolGateway,schoolImg:t.data.schoolImg},e.fileList=t.data.schoolGuide.split(",");for(var o=0;o<e.fileList.length;o++)e.fileList[o]={uid:o,name:"image.png",status:"done",url:e.fileList[o]}}}))},onSubmit:function(){var e=this,t=this;this.$refs.form.validate((function(o){if(o){var r=e.form.coordinates.split(",");e.form.longitude=r[0],e.form.latitude=r[1],e.form.schoolGuide="";for(var s=0;s<e.fileList.length;s++)e.form.schoolGuide+=e.fileList[s].url,s+1<e.fileList.length&&(e.form.schoolGuide+=",");e.form.id?Object(a.c)(e.form).then((function(o){0===o.code?(t.$message.success("保存成功"),e.$router.go(-1)):t.$message.error("保存失败")})):Object(a.b)(e.form).then((function(o){0===o.code?(t.$message.success("保存成功"),e.$router.go(-1)):t.$message.error("保存失败")}))}}))},uploadPosterLogo:function(e){"uploading"!==e.file.status?"done"===e.file.status&&(this.form.schoolImg=e.file.response.data,this.loading=!1):this.loading=!0},handleChange:function(e){var t=e.fileList,o=t.length-1;null!=t[o].response&&(t[o]={name:t[o].name,status:t[o].status,uid:t[o].uid,url:t[o].response.data}),this.fileList=t}},created:function(){this.init()},mounted:function(){}},s=(o("b7f6"),o("cba8")),n=Object(s.a)(r,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{},[o("TitleName",{attrs:{titleName:"校园导览"},scopedSlots:e._u([{key:"edit",fn:function(){return[o("a-button",{attrs:{shape:"round",type:"primary"},on:{click:e.onSubmit}},[e._v(" 保存 ")])]},proxy:!0}])}),o("div",{staticClass:"content"},[o("a-form-model",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-col":e.labelCol,"wrapper-col":e.wrapperCol}},[o("a-form-model-item",{ref:"coordinates",attrs:{label:"学校坐标",prop:"coordinates"}},[o("a-input",{attrs:{placeholder:"请输入"},model:{value:e.form.coordinates,callback:function(t){e.$set(e.form,"coordinates",t)},expression:"form.coordinates"}}),o("a",{staticClass:"query-but",attrs:{href:"http://api.map.baidu.com/lbsapi/getpoint/index.html",target:"_blank"}},[e._v(" 查询坐标 ")])],1),o("a-form-model-item",{ref:"schoolImg",attrs:{label:"学校logo",prop:"schoolImg"}},[o("div",[e._v("请上传学校logo，建议上传png格式的图片")]),o("div",{staticClass:"logo"},[e.form.schoolImg?o("img",{attrs:{src:e.form.schoolImg,alt:"avatar"}}):e._e(),o("a-upload",{staticClass:"avatar-uploader",attrs:{"list-type":"picture-card",action:"https://test01.bysnt.com/welcome-report-api/oss/upload","show-upload-list":!1},on:{change:e.uploadPosterLogo}},[e.form.schoolImg?o("div",{staticClass:"update-logo"},[o("img",{attrs:{src:e.form.schoolImg,alt:"avatar"}})]):o("div",[o("a-icon",{attrs:{type:e.loading?"loading":"plus"}}),o("div",{staticClass:"ant-upload-text"},[e._v(" 上传 ")])],1)])],1)]),o("a-form-model-item",{ref:"",attrs:{label:"校园指引",prop:""}},[o("div",[e._v("请上传学校平面图")]),o("a-upload",{attrs:{action:"https://test01.bysnt.com/welcome-report-api/oss/upload","list-type":"picture-card","file-list":e.fileList},on:{change:e.handleChange}},[e.fileList.length<3?o("div",[o("a-icon",{attrs:{type:"plus"}})],1):e._e()])],1),o("a-form-model-item",{ref:"schoolGateway",attrs:{label:"校园门户",prop:"schoolGateway"}},[o("a-input",{attrs:{placeholder:"请输入校园门户url"},model:{value:e.form.schoolGateway,callback:function(t){e.$set(e.form,"schoolGateway",t)},expression:"form.schoolGateway"}})],1)],1)],1)],1)}),[],!1,null,"bbbf2316",null);t.default=n.exports},b476:function(e,t,o){"use strict";o.d(t,"a",(function(){return l})),o.d(t,"c",(function(){return c})),o.d(t,"b",(function(){return u}));o("3b32");var a=o("b775"),r={tenantId:sessionStorage.getItem("tenantId"),orgId:sessionStorage.getItem("orgId"),garde:JSON.parse(localStorage.getItem("stuGradeId"))},s=r.orgId,n=r.garde,i="".concat(r.tenantId,"/").concat(s,"/").concat(n);function l(){return Object(a.a)({url:"/guideInfo/guideInfoInfo/".concat(i),method:"get"})}function c(e){return Object(a.a)({url:"/guideInfo/updateGuideInfo",method:"post",data:e})}function u(e){return Object(a.a)({url:"/guideInfo/insertGuideInfo/".concat(i),method:"post",data:e})}},b775:function(e,t,o){"use strict";o("75b5"),o("9188"),o("6236"),o("9c7e");var a=o("cebe"),r=o.n(a),s=o("f3e4"),n=r.a.create({baseURL:"https://test01.bysnt.com/welcome-report-api",withCredentials:!0,timeout:3e4});r.a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",n.interceptors.request.use((function(e){e.method;var t=Object(s.a)();return t&&(e.headers.token=t,e.headers["Cache-Control"]="no-cache",e.headers.Pragma="no-cache"),sessionStorage.getItem("user_info")&&(e.headers.tenantId=JSON.parse(sessionStorage.getItem("user_info")).tenantId),e}),(function(e){return Promise.reject(e)})),n.interceptors.response.use((function(e){var t=Number(e.data.code);if(0===t||200===t||500===t)return e.data;switch(t){case 401:localStorage.clear(),sessionStorage.clear(),Object(s.b)(),sessionStorage.setItem("backUrl",location.pathname+location.search),location.href="https://passportss2.hseduyun.net/passport/oauth/authorize?client_id=E0D55D80AAC660E8&response_type=code&redirect_uri=http://127.0.0.1:5500/management/index";break;default:return Promise.reject(e.message||"error")}}),(function(e){return Promise.reject(e)})),t.a=n},b7f6:function(e,t,o){"use strict";o("e962")},e962:function(e,t,o){}}]);