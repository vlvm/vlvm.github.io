(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-f9ba4796"],{"185a":function(t,e,a){"use strict";a("d14c")},"98db":function(t,e,a){"use strict";a.r(e);a("75b5"),a("f132"),a("8133"),a("e54e"),a("3b32"),a("dae5");var s=a("7850"),n=a("f3e4"),i=a("cebe"),o=a.n(i),r=[{title:"姓名",className:"table-tr-name",dataIndex:"name",width:100},{title:"性别",className:"table-tr",dataIndex:"sex",width:70,scopedSlots:{customRender:"sex"}},{title:"身份证号",className:"table-tr",dataIndex:"idCard"},{title:"准考证号",className:"table-tr",dataIndex:"researchNo"},{title:"毕业学校",className:"table-tr",dataIndex:"graduationSchool",width:100},{title:"指定班级",className:"table-tr",dataIndex:"shiftResults",width:100,scopedSlots:{customRender:"shiftResults"}},{title:"操作",className:"table-tr",scopedSlots:{customRender:"action"},width:170}],l={name:"Results",components:{Pagination:function(){return a.e("chunk-01b6ac80").then(a.bind(null,"e0a1"))}},data:function(){return{visible:!1,queryParams:{shiftResults:"",name:null},form:{},labelCol:{span:4},wrapperCol:{span:20},columns:r,data:[],pageNum:1,pageSize:10,totalPeop:0,spinning:!1,echartSpinning:!1,classList:[],settings:{}}},computed:{},watch:{},methods:{getSettings:function(){var t=this;Object(s.j)().then((function(e){e.data.status=-1===e.data.divisionStrategy.indexOf("6"),t.settings=e.data}))},getList:function(){var t=this;this.spinning=!0,Object(s.q)({pageNum:this.pageNum,pageSize:this.pageSize,className:this.queryParams.shiftResults,name:this.queryParams.name}).then((function(e){t.data=e.data.rows,t.totalPeop=e.totalPeop,t.spinning=!1})),Object(s.d)().then((function(e){t.classList=e.data}))},search:function(){this.pageNum=1,this.getList()},changePageNum:function(t,e){"next"===t?this.getList(this.pageNum+=1):"prev"===t?this.getList(this.pageNum-=1):"goTo"===t&&this.getList(e)},next:function(){this.$parent.next()},prev:function(){this.$parent.prev()},deleteAllChange:function(){this.$createElement;var t=this;this.$confirm({title:"确认删除本次分班",content:function(t){return t("div",{style:"margin-left:-38px;margin-top:20px;"},["删除后您可重新执行分班"])},icon:"1",closable:!0,onOk:function(){Object(s.g)().then((function(e){t.$message.success("删除成功"),t.$parent.prev()})).catch((function(e){t.$message.error("删除失败")}))},onCancel:function(){}})},exportChange:function(){var t=Object(n.a)(),e="".concat(sessionStorage.getItem("tenantId"),"/").concat(sessionStorage.getItem("orgId"),"/").concat(JSON.parse(localStorage.getItem("stuGradeId")));o.a.get("https://test01.bysnt.com/welcome-report-api/classes/export/".concat(e),{responseType:"arraybuffer",headers:{token:t}}).then((function(t){var e=new Blob([t.data],{type:"application/vnd.ms-excel;"}),a=document.createElement("a"),s=window.URL.createObjectURL(e);a.href=s,a.download="文档.xls",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(s)}))},adjust:function(t){var e=this;this.settings.status||(null!=t&&null!=t.id?(Object(s.p)({studentId:t.id}).then((function(t){e.form=t.data})),this.visible=!0):this.$message.error("数据错误"))},handleOk:function(){var t=this;this.$refs.form.validate((function(e){if(e){for(var a={studentInfoId:t.form.id,newClassId:null},n=0;n<t.classList.length;n++)t.form.shiftResults===t.classList[n].className&&(a.newClassId=t.classList[n].id);null!=a.newClassId?Object(s.r)(a).then((function(e){t.$message.success("调整成功"),t.getList(),t.visible=!1})).catch((function(e){t.$message.error("调整失败")})):t.$message.error("数据错误")}}))},completeChange:function(){this.$createElement;var t=this;this.$confirm({title:"确认完成分班",content:function(t){return t("div",{style:"margin-left:-38px;margin-top:20px;"},["确认完成分班？确认后将结束预览和编辑"])},icon:"1",closable:!0,onOk:function(){Object(s.f)().then((function(e){t.$message.success("分班成功"),t.$parent.next()})).catch((function(e){t.$message.error("分班失败")}))},onCancel:function(){}})},drawChart:function(){var t=this,e=null;this.echartSpinning=!0,Object(s.e)().then((function(a){e=a.data;for(var s=0;s<e.classesName.length;s++)e.classesName[s]+="班";t.$echarts.init(t.$refs.barChart).setOption({title:{text:""},tooltip:{trigger:"axis"},legend:{data:["男","女","人数"]},xAxis:{type:"category",data:e.classesName,axisPointer:{type:"shadow"}},yAxis:{},series:[{name:"男",type:"bar",data:e.malePeopleNum,itemStyle:{color:"#4297C3",borderRadius:[4,4,0,0]},barWidth:12},{name:"女",type:"bar",data:e.femalePeopleNum,itemStyle:{color:"#C8CDDF",borderRadius:[4,4,0,0]},barWidth:12,barGap:"60%"},{name:"人数",type:"line",data:e.peopleTotal,itemStyle:{color:"#E9CA73"}}]}),t.echartSpinning=!1})).catch((function(){t.$message.error("图表加载失败")}))}},filters:{tableSex:function(t){return 1==t?"男":"女"}},created:function(){this.getSettings(),this.getList()},mounted:function(){this.drawChart()}},c=(a("185a"),a("cba8")),u=Object(c.a)(l,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main"},[a("div",{staticClass:"content"},[a("div",{staticClass:"search-box"},[a("a-form-model",{ref:"form",attrs:{model:t.queryParams,layout:"inline"}},[a("a-form-model-item",{ref:"shiftResults",attrs:{label:"班级",prop:"shiftResults",colon:!1}},[a("a-select",{staticStyle:{width:"190px"},model:{value:t.queryParams.shiftResults,callback:function(e){t.$set(t.queryParams,"shiftResults",e)},expression:"queryParams.shiftResults"}},[a("a-select-option",{attrs:{value:""}},[t._v(" 全部 ")]),t._l(t.classList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.className}},[t._v(" "+t._s(e.className)+"班 ")])}))],2)],1),a("a-form-model-item",{ref:"name",attrs:{label:" ",prop:"name",colon:!1}},[a("a-input-search",{staticClass:"search-input",attrs:{placeholder:"请输入姓名搜索"},on:{search:t.getList},model:{value:t.queryParams.name,callback:function(e){t.$set(t.queryParams,"name",e)},expression:"queryParams.name"}},[a("a-icon",{attrs:{slot:"prefix",type:"search"},slot:"prefix"}),a("a-button",{staticClass:"search-but",attrs:{slot:"enterButton",type:"primary"},on:{click:t.search},slot:"enterButton"},[t._v(" 搜索 ")])],1)],1)],1),a("a-button",{attrs:{type:"primary"},on:{click:t.completeChange}},[t._v(" 完成分班 ")])],1),a("div",{staticClass:"table-box"},[a("Pagination",{attrs:{pageNum:t.pageNum,pageSize:t.pageSize,total:t.totalPeop},on:{getList:t.getList,changePageNum:t.changePageNum},scopedSlots:t._u([{key:"pagination_left",fn:function(){return[a("a-button",{staticClass:"base border",attrs:{size:"small",shape:"round"},on:{click:t.deleteAllChange}},[t._v(" 删除所有分班 ")]),a("a-button",{staticClass:"base border",attrs:{size:"small",shape:"round"},on:{click:t.exportChange}},[t._v(" 导出 ")])]},proxy:!0}])}),a("a-spin",{attrs:{tip:"数据加载中...",spinning:t.spinning,delay:100}},[a("a-table",{attrs:{columns:t.columns,"data-source":t.data,rowKey:function(t){return t.id},pagination:!1},scopedSlots:t._u([{key:"sex",fn:function(e){return[t._v(" "+t._s(t._f("tableSex")(e))+" ")]}},{key:"shiftResults",fn:function(e){return[t._v(" "+t._s(e)+"班 ")]}},{key:"action",fn:function(e,s){return[a("a-button",{staticClass:"btn-a-blue",attrs:{type:"link",disabled:t.settings.status},on:{click:function(e){return t.adjust(s)}}},[t._v(" 调整 ")])]}}])})],1),a("Pagination",{attrs:{pageNum:t.pageNum,pageSize:t.pageSize,total:t.totalPeop},on:{getList:t.getList,changePageNum:t.changePageNum}})],1),a("a-spin",{attrs:{tip:"数据加载中...",spinning:t.echartSpinning,delay:100}},[a("div",{ref:"barChart",staticClass:"barChart-box"})])],1),a("a-modal",{attrs:{title:"分班结果调整"},on:{ok:t.handleOk},model:{value:t.visible,callback:function(e){t.visible=e},expression:"visible"}},[a("a-form-model",{attrs:{model:t.form,"label-col":t.labelCol,"wrapper-col":t.wrapperCol}},[a("a-form-model-item",{ref:"name",attrs:{label:"学生",prop:"name",colon:!1}},[a("span",[t._v(t._s(t.form.name))])]),a("a-form-model-item",{ref:"sex",attrs:{label:"性别",prop:"sex",colon:!1}},[a("span",[t._v(t._s(t._f("tableSex")(t.form.sex)))])]),a("a-form-model-item",{ref:"idCard",attrs:{label:"身份证号",prop:"idCard",colon:!1}},[a("span",[t._v(t._s(t.form.idCard))])]),a("a-form-model-item",{ref:"graduationSchool",attrs:{label:"学校",prop:"graduationSchool",colon:!1}},[a("span",[t._v(t._s(t.form.graduationSchool))])]),a("a-form-model-item",{ref:"shiftResults",attrs:{label:"班级",prop:"shiftResults",colon:!1}},[a("a-select",{staticStyle:{width:"190px"},attrs:{placeholder:"请选择班级"},model:{value:t.form.shiftResults,callback:function(e){t.$set(t.form,"shiftResults",e)},expression:"form.shiftResults"}},t._l(t.classList,(function(e){return a("a-select-option",{key:e.id,attrs:{value:e.className}},[t._v(" "+t._s(e.className)+"班 ")])})),1)],1)],1)],1)],1)}),[],!1,null,"0f5cf730",null);e.default=u.exports},d14c:function(t,e,a){}}]);